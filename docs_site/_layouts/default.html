<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% if page.title %}{{ page.title }} - {% endif %}{{ site.title }}</title>
  <meta name="description" content="{{ site.description }}">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      line-height: 1.6;
      color: #333;
      background: #fff;
    }

    header {
      background: #2c3e50;
      color: white;
      padding: 2rem 0;
      text-align: center;
    }

    header h1 {
      font-size: 2.5rem;
      margin-bottom: 0.5rem;
    }

    header h1 a {
      color: white;
      text-decoration: none;
    }

    header p {
      font-size: 1.2rem;
      opacity: 0.9;
    }

    nav {
      background: #34495e;
      padding: 1rem 0;
      text-align: center;
    }

    nav a {
      color: white;
      text-decoration: none;
      margin: 0 1rem;
      padding: 0.5rem 1rem;
      display: inline-block;
    }

    nav a:hover {
      background: #2c3e50;
    }

    main {
      max-width: 1200px;
      margin: 2rem auto;
      padding: 0 2rem;
    }

    section {
      margin: 3rem 0;
    }

    h1,
    h2 {
      color: #2c3e50;
      margin-bottom: 1rem;
    }

    h1 {
      font-size: 2.5rem;
    }

    h2 {
      font-size: 2rem;
    }

    h3 {
      font-size: 1.5rem;
      color: #34495e;
      margin-top: 2rem;
      margin-bottom: 1rem;
    }

    code {
      background: #f4f4f4;
      padding: 0.2rem 0.4rem;
      border-radius: 3px;
      font-family: 'Courier New', monospace;
      font-size: 0.9em;
    }

    pre {
      background: #f4f4f4;
      padding: 1rem;
      border-radius: 5px;
      overflow-x: auto;
      margin: 1rem 0;
    }

    pre code {
      background: none;
      padding: 0;
    }

    footer {
      background: #2c3e50;
      color: white;
      text-align: center;
      padding: 2rem 0;
      margin-top: 4rem;
    }

    .cta {
      background: #3498db;
      color: white;
      padding: 1rem 2rem;
      border-radius: 5px;
      text-decoration: none;
      display: inline-block;
      margin: 1rem 0;
    }

    .cta:hover {
      background: #2980b9;
    }

    ul,
    ol {
      margin-left: 2rem;
      margin-bottom: 1rem;
    }

    li {
      margin-bottom: 0.5rem;
    }

    blockquote {
      border-left: 4px solid #3498db;
      padding-left: 1rem;
      margin: 1rem 0;
      color: #666;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin: 1rem 0;
    }

    th,
    td {
      border: 1px solid #ddd;
      padding: 0.5rem;
      text-align: left;
    }

    th {
      background: #f4f4f4;
      font-weight: 600;
    }

    /* Mermaid diagram styles */
    .mermaid {
      margin: 2rem 0;
      text-align: center;
    }

    /* Animations */
    @keyframes fadeIn {
      from {
        opacity: 0;
      }

      to {
        opacity: 1;
      }
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: scale(0.9) translateY(-20px);
      }

      to {
        opacity: 1;
        transform: scale(1) translateY(0);
      }
    }

            /* Responsive adjustments */
            @media (max-width: 768px) {
              .mermaid {
                margin: 1rem 0;
              }
            }
  </style>
</head>

<body>
  {% include header.html %}

  <main>
    {{ content }}
  </main>

  <footer>
    <p>&copy; {{ 'now' | date: "%Y" }} Rails Accessibility Testing. MIT License.</p>
    <p><a href="https://github.com/rayraycodes/rails-accessibility-testing" style="color: white;">GitHub</a></p>
  </footer>

  <!-- Mermaid.js for diagram rendering - Use regular script for GitHub Pages compatibility -->
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
  <script>
    // Initialize Mermaid when loaded
    (function() {
      function initMermaidLib() {
        if (typeof mermaid !== 'undefined') {
          mermaid.initialize({
            startOnLoad: false, // We'll call run() manually
            theme: 'default',
            securityLevel: 'loose',
            flowchart: { useMaxWidth: true },
            sequence: { useMaxWidth: true },
            gantt: { useMaxWidth: true }
          });
          window.mermaid = mermaid;
          return true;
        }
        return false;
      }
      
      // Try to initialize immediately
      if (!initMermaidLib()) {
        // If not loaded yet, wait for it
        const checkInterval = setInterval(() => {
          if (initMermaidLib()) {
            clearInterval(checkInterval);
          }
        }, 50);
        
        // Stop checking after 5 seconds
        setTimeout(() => clearInterval(checkInterval), 5000);
      }
    })();


    // Make processMermaidDiagrams available globally
    window.processMermaidDiagrams = function() {
      console.log('Processing Mermaid diagrams...');
      
      if (typeof mermaid === 'undefined') {
        console.error('Mermaid not loaded yet');
        return;
      }
      
      // Find all code blocks with mermaid language - try multiple selectors
      let mermaidBlocks = document.querySelectorAll('code.language-mermaid, pre code.language-mermaid, code[class*="mermaid"], pre code[class*="language-mermaid"]');
      
      // If none found, check all code blocks for mermaid syntax
      if (mermaidBlocks.length === 0) {
        console.log('No mermaid language blocks found, checking all code blocks for mermaid syntax...');
        const allCodeBlocks = document.querySelectorAll('pre code');
        const foundBlocks = [];
        allCodeBlocks.forEach(block => {
          const code = block.textContent || block.innerText;
          if (code.trim().match(/^(graph|sequenceDiagram|flowchart|classDiagram|stateDiagram|erDiagram|gantt|pie|gitgraph|journey)/)) {
            foundBlocks.push(block);
          }
        });
        mermaidBlocks = foundBlocks;
      }
      
      console.log('Found', mermaidBlocks.length, 'Mermaid code blocks');

      if (mermaidBlocks.length > 0) {
        // Process each block
        mermaidBlocks.forEach((block, index) => {
          // Get the parent pre element if it exists
          const preElement = block.parentElement;
          if (preElement && preElement.tagName === 'PRE') {
            // Get the mermaid code
            const mermaidCode = block.textContent || block.innerText;
            console.log('Processing Mermaid block', index + 1, ':', mermaidCode.substring(0, 50) + '...');

            // Create a div for Mermaid to render into
            const mermaidDiv = document.createElement('div');
            mermaidDiv.className = 'mermaid';
            mermaidDiv.textContent = mermaidCode;

            // Replace the pre element with the mermaid div
            preElement.parentNode.replaceChild(mermaidDiv, preElement);
          }
        });

        // Run Mermaid to render all diagrams
        console.log('Running Mermaid render...');
        mermaid.run().then(() => {
          console.log('Mermaid rendering complete');
        }).catch((err) => {
          console.error('Mermaid rendering error:', err);
        });
      } else {
        // Fallback: look for pre > code blocks and check if they contain mermaid syntax
        console.log('No mermaid language blocks found, checking all code blocks...');
        const allCodeBlocks = document.querySelectorAll('pre code');
        let foundMermaid = false;
        
        allCodeBlocks.forEach((codeBlock) => {
          const code = codeBlock.textContent || codeBlock.innerText;
          // Check if it looks like mermaid code (starts with graph, sequenceDiagram, etc.)
          if (code.trim().match(/^(graph|sequenceDiagram|flowchart|classDiagram|stateDiagram|erDiagram|gantt|pie|gitgraph|journey)/)) {
            foundMermaid = true;
            const preElement = codeBlock.parentElement;
            if (preElement && preElement.tagName === 'PRE') {
              const mermaidDiv = document.createElement('div');
              mermaidDiv.className = 'mermaid';
              mermaidDiv.textContent = code;
              preElement.parentNode.replaceChild(mermaidDiv, preElement);
            }
          }
        });

        // Run Mermaid after processing
        if (foundMermaid && document.querySelectorAll('.mermaid').length > 0) {
          console.log('Running Mermaid render (fallback)...');
          mermaid.run().then(() => {
            console.log('Mermaid rendering complete (fallback)');
          }).catch((err) => {
            console.error('Mermaid rendering error (fallback):', err);
          });
        } else {
          console.log('No Mermaid diagrams found to render');
        }
      }
    };

    // Wait for Mermaid to load, then process diagrams
    function waitForMermaidAndProcess() {
      if (typeof mermaid !== 'undefined' && typeof window.processMermaidDiagrams === 'function') {
        // Wait a bit for Jekyll/Kramdown to finish processing
        setTimeout(() => {
          window.processMermaidDiagrams();
        }, 300);
      } else {
        // Mermaid not loaded yet, wait and try again
        setTimeout(waitForMermaidAndProcess, 100);
      }
    }

    // Process diagrams when DOM is ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', waitForMermaidAndProcess);
    } else {
      // DOM already loaded, wait for Mermaid
      waitForMermaidAndProcess();
    }
  </script>
</body>

</html>
</html>